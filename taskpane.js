/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},44809:function(e,t){var r,n;r=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},r=!t.document&&!!t.postMessage,n=t.IS_PAPA_WORKER||!1,i={},o=0,s={parse:function(r,n){var a=(n=n||{}).dynamicTyping||!1;if(_(a)&&(n.dynamicTypingFunction=a,a={}),n.dynamicTyping=a,n.transform=!!_(n.transform)&&n.transform,n.worker&&s.WORKERS_SUPPORTED){var u=function(){if(!s.WORKERS_SUPPORTED)return!1;var r,n,a=(r=t.URL||t.webkitURL||null,n=e.toString(),s.BLOB_URL||(s.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",n,")();"],{type:"text/javascript"})))),u=new t.Worker(a);return u.onmessage=v,u.id=o++,i[u.id]=u}();return u.userStep=n.step,u.userChunk=n.chunk,u.userComplete=n.complete,u.userError=n.error,n.step=_(n.step),n.chunk=_(n.chunk),n.complete=_(n.complete),n.error=_(n.error),delete n.worker,void u.postMessage({input:r,config:n,workerId:u.id})}var p=null;return s.NODE_STREAM_INPUT,"string"==typeof r?(r=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(r),p=n.download?new c(n):new f(n)):!0===r.readable&&_(r.read)&&_(r.on)?p=new h(n):(t.File&&r instanceof File||r instanceof Object)&&(p=new l(n)),p.stream(r)},unparse:function(e,t){var r=!1,n=!0,i=",",o="\r\n",a='"',u=a+a,c=!1,l=null,f=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+a),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(f=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(d(a),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,c);if("object"==typeof e[0])return p(l||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||l),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function p(e,t,r){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(a&&n){for(var c=0;c<e.length;c++)0<c&&(s+=i),s+=y(e[c],c);0<t.length&&(s+=o)}for(var l=0;l<t.length;l++){var f=a?e.length:t[l].length,h=!1,p=a?0===Object.keys(t[l]).length:0===t[l].length;if(r&&!a&&(h="greedy"===r?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===r&&a){for(var d=[],v=0;v<f;v++){var m=u?e[v]:v;d.push(t[l][m])}h=""===d.join("").trim()}if(!h){for(var g=0;g<f;g++){0<g&&!p&&(s+=i);var b=a&&u?e[g]:g;s+=y(t[l][b],g)}l<t.length-1&&(!r||0<f&&!p)&&(s+=o)}}return s}function y(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var n=!1;f&&"string"==typeof e&&f.test(e)&&(e="'"+e,n=!0);var o=e.toString().replace(h,u);return(n=n||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(o,s.BAD_DELIMITERS)||-1<o.indexOf(i)||" "===o.charAt(0)||" "===o.charAt(o.length-1))?a+o+a:o}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!r&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=y,s.ParserHandle=p,s.NetworkStreamer=c,s.FileStreamer=l,s.StringStreamer=f,s.ReadableStreamStreamer=h,t.jQuery){var a=t.jQuery;a.fn.parse=function(e){var r=e.config||{},n=[];return this.each((function(e){if("INPUT"!==a(this).prop("tagName").toUpperCase()||"file"!==a(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)n.push({file:this.files[i],inputElem:this,instanceConfig:a.extend({},r)})})),i(),this;function i(){if(0!==n.length){var t,r,i,u=n[0];if(_(e.before)){var c=e.before(u.file,u.inputElem);if("object"==typeof c){if("abort"===c.action)return"AbortError",t=u.file,r=u.inputElem,i=c.reason,void(_(e.error)&&e.error({name:"AbortError"},t,r,i));if("skip"===c.action)return void o();"object"==typeof c.config&&(u.instanceConfig=a.extend(u.instanceConfig,c.config))}else if("skip"===c)return void o()}var l=u.instanceConfig.complete;u.instanceConfig.complete=function(e){_(l)&&l(e,u.file,u.inputElem),o()},s.parse(u.file,u.instanceConfig)}else _(e.complete)&&e.complete()}function o(){n.splice(0,1),i()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new p(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,r){if(this.isFirstChunk&&_(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var a=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=a.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),a&&a.data&&(this._rowCount+=a.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)t.postMessage({results:a,workerId:s.WORKER_ID,finished:c});else if(_(this._config.chunk)&&!r){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!c||!_(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){_(this._config.error)?this._config.error(e):n&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),u.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var n in e)t.setRequestHeader(n,e[n])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function l(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),u.call(this,e);var n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,i)}var o=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){u.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=w((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=w((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=w((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=w((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function p(e){var t,r,n,i=Math.pow(2,53),o=-i,a=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,l=0,f=0,h=!1,p=!1,v=[],m={data:[],errors:[],meta:{}};if(_(e.step)){var g=e.step;e.step=function(t){if(m=t,x())E();else{if(E(),0===m.data.length)return;l+=t.data.length,e.preview&&l>e.preview?r.abort():(m.data=m.data[0],g(m,c))}}}function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){return m&&n&&(S("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(m.data=m.data.filter((function(e){return!w(e)}))),x()&&function(){if(m)if(Array.isArray(m.data[0])){for(var t=0;x()&&t<m.data.length;t++)m.data[t].forEach(r);m.data.splice(0,1)}else m.data.forEach(r);function r(t,r){_(e.transformHeader)&&(t=e.transformHeader(t,r)),v.push(t)}}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,r){var n,i=e.header?{}:[];for(n=0;n<t.length;n++){var o=n,s=t[n];e.header&&(o=n>=v.length?"__parsed_extra":v[n]),e.transform&&(s=e.transform(s,o)),s=k(o,s),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(s)):i[o]=s}return e.header&&(n>v.length?S("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+n,f+r):n<v.length&&S("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+n,f+r)),i}var r=1;return!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),r=m.data.length):m.data=t(m.data,0),e.header&&m.meta&&(m.meta.fields=v),f+=r,m}()}function x(){return e.header&&0===v.length}function k(t,r){return n=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(a.test(e)){var t=parseFloat(e);if(o<t&&t<i)return!0}return!1}(r)?parseFloat(r):u.test(r)?new Date(r):""===r?null:r):r;var n}function S(e,t,r,n){var i={type:e,code:t,message:r};void 0!==n&&(i.row=n),m.errors.push(i)}this.parse=function(i,o,a){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(d(t)+"([^]*?)"+d(t),"gm"),n=(e=e.replace(r,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<n[0].length;if(1===n.length||o)return"\n";for(var s=0,a=0;a<n.length;a++)"\n"===n[a][0]&&s++;return s>=n.length/2?"\r\n":"\r"}(i,u)),n=!1,e.delimiter)_(e.delimiter)&&(e.delimiter=e.delimiter(i),m.meta.delimiter=e.delimiter);else{var c=function(t,r,n,i,o){var a,u,c,l;o=o||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var f=0;f<o.length;f++){var h=o[f],p=0,d=0,v=0;c=void 0;for(var m=new y({comments:i,delimiter:h,newline:r,preview:10}).parse(t),g=0;g<m.data.length;g++)if(n&&w(m.data[g]))v++;else{var b=m.data[g].length;d+=b,void 0!==c?0<b&&(p+=Math.abs(b-c),c=b):c=b}0<m.data.length&&(d/=m.data.length-v),(void 0===u||p<=u)&&(void 0===l||l<d)&&1.99<d&&(u=p,a=h,l=d)}return{successful:!!(e.delimiter=a),bestDelimiter:a}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(n=!0,e.delimiter=s.DefaultDelimiter),m.meta.delimiter=e.delimiter}var l=b(e);return e.preview&&e.header&&l.preview++,t=i,r=new y(l),m=r.parse(t,o,a),E(),h?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,r.abort(),t=_(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){c.streamer._halted?(h=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,r.abort(),m.meta.aborted=!0,_(e.complete)&&e.complete(m),t=""}}function d(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(e){var t,r=(e=e||{}).delimiter,n=e.newline,i=e.comments,o=e.step,a=e.preview,u=e.fastMode,c=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof r||-1<s.BAD_DELIMITERS.indexOf(r))&&(r=","),i===r)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var l=0,f=!1;this.parse=function(s,h,p){if("string"!=typeof s)throw new Error("Input must be a string");var y=s.length,v=r.length,m=n.length,g=i.length,b=_(o),w=[],E=[],x=[],k=l=0;if(!s)return W();if(e.header&&!h){var S=s.split(n)[0].split(r),R=[],O={},T=!1;for(var A in S){var C=S[A];_(e.transformHeader)&&(C=e.transformHeader(C,A));var D=C,I=O[C]||0;for(0<I&&(T=!0,D=C+"_"+I),O[C]=I+1;R.includes(D);)D=D+"_"+I;R.push(D)}if(T){var M=s.split(n);M[0]=R.join(r),s=M.join(n)}}if(u||!1!==u&&-1===s.indexOf(t)){for(var P=s.split(n),j=0;j<P.length;j++){if(x=P[j],l+=x.length,j!==P.length-1)l+=n.length;else if(p)return W();if(!i||x.substring(0,g)!==i){if(b){if(w=[],B(x.split(r)),K(),f)return W()}else B(x.split(r));if(a&&a<=j)return w=w.slice(0,a),W(!0)}}return W()}for(var L=s.indexOf(r,l),F=s.indexOf(n,l),U=new RegExp(d(c)+d(t),"g"),N=s.indexOf(t,l);;)if(s[l]!==t)if(i&&0===x.length&&s.substring(l,l+g)===i){if(-1===F)return W();l=F+m,F=s.indexOf(n,l),L=s.indexOf(r,l)}else if(-1!==L&&(L<F||-1===F))x.push(s.substring(l,L)),l=L+v,L=s.indexOf(r,l);else{if(-1===F)break;if(x.push(s.substring(l,F)),Y(F+m),b&&(K(),f))return W();if(a&&w.length>=a)return W(!0)}else for(N=l,l++;;){if(-1===(N=s.indexOf(t,N+1)))return p||E.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:l}),q();if(N===y-1)return q(s.substring(l,N).replace(U,t));if(t!==c||s[N+1]!==c){if(t===c||0===N||s[N-1]!==c){-1!==L&&L<N+1&&(L=s.indexOf(r,N+1)),-1!==F&&F<N+1&&(F=s.indexOf(n,N+1));var z=H(-1===F?L:Math.min(L,F));if(s.substr(N+1+z,v)===r){x.push(s.substring(l,N).replace(U,t)),s[l=N+1+z+v]!==t&&(N=s.indexOf(t,l)),L=s.indexOf(r,l),F=s.indexOf(n,l);break}var $=H(F);if(s.substring(N+1+$,N+1+$+m)===n){if(x.push(s.substring(l,N).replace(U,t)),Y(N+1+$+m),L=s.indexOf(r,l),N=s.indexOf(t,l),b&&(K(),f))return W();if(a&&w.length>=a)return W(!0);break}E.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:l}),N++}}else N++}return q();function B(e){w.push(e),k=l}function H(e){var t=0;if(-1!==e){var r=s.substring(N+1,e);r&&""===r.trim()&&(t=r.length)}return t}function q(e){return p||(void 0===e&&(e=s.substring(l)),x.push(e),l=y,B(x),b&&K()),W()}function Y(e){l=e,B(x),x=[],F=s.indexOf(n,l)}function W(e){return{data:w,errors:E,meta:{delimiter:r,linebreak:n,aborted:f,truncated:!!e,cursor:k+(h||0)}}}function K(){o(W()),w=[],E=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return l}}function v(e){var t=e.data,r=i[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){n=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:g,resume:g};if(_(r.userStep)){for(var s=0;s<t.results.data.length&&(r.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},o),!n);s++);delete t.results}else _(r.userChunk)&&(r.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!n&&m(t.workerId,t.results)}function m(e,t){var r=i[e];_(r.userComplete)&&r.userComplete(t),r.terminate(),delete i[e]}function g(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=b(e[r]);return t}function w(e,t){return function(){e.apply(t,arguments)}}function _(e){return"function"==typeof e}return n&&(t.onmessage=function(e){var r=e.data;if(void 0===s.WORKER_ID&&r&&(s.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:s.WORKER_ID,results:s.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var n=s.parse(r.input,r.config);n&&t.postMessage({workerId:s.WORKER_ID,results:n,finished:!0})}}),(c.prototype=Object.create(u.prototype)).constructor=c,(l.prototype=Object.create(u.prototype)).constructor=l,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,s},void 0===(n=r.apply(t,[]))||(e.exports=n)},58394:function(e,t,r){"use strict";e.exports=r.p+"b857c2e97f8ad995b172.css"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r.b=document.baseURI||self.location.href,function(){"use strict";function e(e){return"function"==typeof e}function t(t){return function(r){if(function(t){return e(null==t?void 0:t.lift)}(r))return r.lift((function(e){try{return t(e,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function s(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function u(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function c(e){return this instanceof c?(this.v=e,this):new c(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var l,f=((l=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),l.prototype.constructor=l,l);function h(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var p=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var r;return t.prototype.unsubscribe=function(){var t,r,n,i,o;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var l=s(c),h=l.next();!h.done;h=l.next())h.value.remove(this)}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}else c.remove(this);var p=this.initialTeardown;if(e(p))try{p()}catch(e){o=e instanceof f?e.errors:[e]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var v=s(d),m=v.next();!m.done;m=v.next()){var g=m.value;try{y(g)}catch(e){o=null!=o?o:[],e instanceof f?o=u(u([],a(o)),a(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}}if(o)throw new f(o)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)y(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&h(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&h(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((r=new t).closed=!0,r),t}();function d(t){return t instanceof p||t&&"closed"in t&&e(t.remove)&&e(t.add)&&e(t.unsubscribe)}function y(t){e(t)?t():t.unsubscribe()}p.EMPTY;var v={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},m={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=m.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,u([e,t],a(r))):setTimeout.apply(void 0,u([e,t],a(r)))},clearTimeout:function(e){var t=m.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function g(e){m.setTimeout((function(){var t=v.onUnhandledError;if(!t)throw e;t(e)}))}function b(){}var w=_("C",void 0,void 0);function _(e,t,r){return{kind:e,value:t,error:r}}var E=null,x=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,d(t)&&t.add(r)):r.destination=C,r}return i(t,e),t.create=function(e,t,r){return new O(e,t,r)},t.prototype.next=function(e){this.isStopped?A(function(e){return _("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?A(_("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?A(w,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(p),k=Function.prototype.bind;function S(e,t){return k.call(e,t)}var R=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){T(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){T(e)}else T(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){T(e)}},e}(),O=function(t){function r(r,n,i){var o,s,a=t.call(this)||this;return e(r)||!r?o={next:null!=r?r:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:a&&v.useDeprecatedNextContext?((s=Object.create(r)).unsubscribe=function(){return a.unsubscribe()},o={next:r.next&&S(r.next,s),error:r.error&&S(r.error,s),complete:r.complete&&S(r.complete,s)}):o=r,a.destination=new R(o),a}return i(r,t),r}(x);function T(e){var t;v.useDeprecatedSynchronousErrorHandling?(t=e,v.useDeprecatedSynchronousErrorHandling&&E&&(E.errorThrown=!0,E.error=t)):g(e)}function A(e,t){var r=v.onStoppedNotification;r&&m.setTimeout((function(){return r(e,t)}))}var C={closed:!0,next:b,error:function(e){throw e},complete:b};function D(e,t,r,n,i){return new I(e,t,r,n,i)}var I=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return i(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(x);function M(e,r){return t((function(t,n){var i=0;t.subscribe(D(n,(function(t){n.next(e.call(r,t,i++))})))}))}function P(e,r){return t(function(e,t,r,n,i){return function(n,i){var o=r,s=t,a=0;n.subscribe(D(i,(function(t){var r=a++;s=o?e(s,t,r):(o=!0,t)}),(function(){o&&i.next(s),i.complete()})))}}(e,r,arguments.length>=2))}var j=function(e,t){return e.push(t),e};function L(){return t((function(e,t){P(j,[])(e).subscribe(t)}))}function F(e){return e}function U(r,n,i){var o=e(r)||n||i?{next:r,error:n,complete:i}:r;return o?t((function(e,t){var r;null===(r=o.subscribe)||void 0===r||r.call(o);var n=!0;e.subscribe(D(t,(function(e){var r;null===(r=o.next)||void 0===r||r.call(o,e),t.next(e)}),(function(){var e;n=!1,null===(e=o.complete)||void 0===e||e.call(o),t.complete()}),(function(e){var r;n=!1,null===(r=o.error)||void 0===r||r.call(o,e),t.error(e)}),(function(){var e,t;n&&(null===(e=o.unsubscribe)||void 0===e||e.call(o)),null===(t=o.finalize)||void 0===t||t.call(o)})))})):F}function N(e,r){return t((function(t,n){var i=0;t.subscribe(D(n,(function(t){return e.call(r,t,i++)&&n.next(t)})))}))}var z=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function $(t){return e(null==t?void 0:t.then)}var B="function"==typeof Symbol&&Symbol.observable||"@@observable";var H=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,r,n){var i,o=this,s=(i=t)&&i instanceof x||function(t){return t&&e(t.next)&&e(t.error)&&e(t.complete)}(i)&&d(i)?t:new O(t,r,n);return function(e){if(v.useDeprecatedSynchronousErrorHandling){var t=!E;if(t&&(E={errorThrown:!1,error:null}),e(),t){var r=E,n=r.errorThrown,i=r.error;if(E=null,n)throw i}}else e()}((function(){var e=o,t=e.operator,r=e.source;s.add(t?t.call(s,r):r?o._subscribe(s):o._trySubscribe(s))})),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},t.prototype.forEach=function(e,t){var r=this;return new(t=q(t))((function(t,n){var i=new O({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},t.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},t.prototype[B]=function(){return this},t.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(r=e).length?F:1===r.length?r[0]:function(e){return r.reduce((function(e,t){return t(e)}),e)})(this);var r},t.prototype.toPromise=function(e){var t=this;return new(e=q(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},t.create=function(e){return new t(e)},t}();function q(e){var t;return null!==(t=null!=e?e:v.Promise)&&void 0!==t?t:Promise}function Y(t){return e(t[B])}function W(t){return Symbol.asyncIterator&&e(null==t?void 0:t[Symbol.asyncIterator])}function K(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Q="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function J(t){return e(null==t?void 0:t[Q])}function G(e){return function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof c?Promise.resolve(r.value.v).then(u,l):f(o[0][2],r)}catch(e){f(o[0][3],e)}var r}function u(e){a("next",e)}function l(e){a("throw",e)}function f(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var t,r,n;return o(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,c(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,c(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,c(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Z(t){return e(null==t?void 0:t.getReader)}function X(t){if(t instanceof H)return t;if(null!=t){if(Y(t))return o=t,new H((function(t){var r=o[B]();if(e(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(z(t))return i=t,new H((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if($(t))return n=t,new H((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,g)}));if(W(t))return V(t);if(J(t))return r=t,new H((function(e){var t,n;try{for(var i=s(r),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.complete()}));if(Z(t))return V(G(t))}var r,n,i,o;throw K(t)}function V(e){return new H((function(t){(function(e,t){var r,n,i,a,u,c,l,f;return u=this,c=void 0,f=function(){var u,c;return o(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=s(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}(e),o.label=1;case 1:return[4,r.next()];case 2:if((n=o.sent()).done)return[3,4];if(u=n.value,t.next(u),t.closed)return[2];o.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=o.sent(),i={error:c},[3,11];case 6:return o.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:o.sent(),o.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{i(f.next(e))}catch(e){t(e)}}function n(e){try{i(f.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof l?i:new l((function(e){e(i)}))).then(r,n)}i((f=f.apply(u,c||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function ee(e,r){return t((function(t,n){var i=null,o=0,s=!1,a=function(){return s&&!i&&n.complete()};t.subscribe(D(n,(function(t){null==i||i.unsubscribe();var s=0,u=o++;X(e(t,u)).subscribe(i=D(n,(function(e){return n.next(r?r(t,e,u,s++):e)}),(function(){i=null,a()})))}),(function(){s=!0,a()})))}))}function te(e){return e[e.length-1]}function re(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=t.schedule((function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(o),!i)return o}function ne(e,r){return void 0===r&&(r=0),t((function(t,n){t.subscribe(D(n,(function(t){return re(n,e,(function(){return n.next(t)}),r)}),(function(){return re(n,e,(function(){return n.complete()}),r)}),(function(t){return re(n,e,(function(){return n.error(t)}),r)})))}))}function ie(e,r){return void 0===r&&(r=0),t((function(t,n){n.add(e.schedule((function(){return t.subscribe(n)}),r))}))}function oe(e,t){if(!e)throw new Error("Iterable cannot be null");return new H((function(r){re(r,t,(function(){var n=e[Symbol.asyncIterator]();re(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function se(t,r){return r?function(t,r){if(null!=t){if(Y(t))return function(e,t){return X(e).pipe(ie(t),ne(t))}(t,r);if(z(t))return function(e,t){return new H((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(t,r);if($(t))return function(e,t){return X(e).pipe(ie(t),ne(t))}(t,r);if(W(t))return oe(t,r);if(J(t))return function(t,r){return new H((function(n){var i;return re(n,r,(function(){i=t[Q](),re(n,r,(function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)}),0,!0)})),function(){return e(null==i?void 0:i.return)&&i.return()}}))}(t,r);if(Z(t))return function(e,t){return oe(G(e),t)}(t,r)}throw K(t)}(t,r):X(t)}function ae(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return se(t,function(t){return(r=te(t))&&e(r.schedule)?t.pop():void 0;var r}(t))}function ue(e){return new H((t=>{Excel.run((async r=>{const n=r.workbook.names.getItem(e).getRange().getUsedRange();n.load("values");try{await r.sync()}catch(t){throw console.error("Error getting range named '"+e+"':",t),t}n.values&&n.values.length>0&&n.values[0].length>0?n.values.flat().filter(((e,t,r)=>""!==e&&r.indexOf(e)===t)).forEach((e=>t.next(e))):t.next("Named range is empty or does not exist"),t.complete()})).catch((e=>t.error(e)))}))}function ce(e){return new H((t=>{Excel.run((async r=>{const n=r.workbook.tables.getItem(e),i=n.getHeaderRowRange().load("values"),o=n.getDataBodyRange().load("values");try{await r.sync()}catch(t){throw console.error("Error getting rows for table '"+e+"':",t),t}const s=i.values[0];o.values.forEach((e=>{const r=s.reduce(((t,r,n)=>(t[r]=e[n],t)),{});t.next(r)})),t.complete()})).catch((e=>t.error(e)))}))}async function le(e,t){fe(e,[Object.values(t)])}async function fe(e,t){try{if(0===t.length)return void console.warn("No data to write to table '"+e+"'.");await Excel.run((async r=>{const n=r.workbook.tables.getItemOrNullObject(e);if(await r.sync(),n.isNullObject)throw new Error(`Table "${e}" not found.`);n.rows.add(null,t),await r.sync()}))}catch(r){throw console.error("Error writing to table:",r),console.error("Could not add data to table '"+e+"':",t),r}}async function he(){return new Promise(((e,t)=>{ue("Expenses").pipe(L(),U((t=>e(t)))).subscribe({error(e){t(e)}})}))}async function pe(e,t,r){return new Promise(((n,i)=>{ce("Transactions").pipe(N((r=>r.Month===e&&r.Year===t)),N((e=>e["Expense Type"]===r)),L(),U((e=>n(e)))).subscribe({error:e=>i(e)})}))}async function de(e,t=null,r=null){return new Promise(((n,i)=>{const o=ce("ExpenseData").pipe(N((t=>t["Expense Type"]===e)),M((e=>e.Budget)));let s=o;t&&r&&(s=ce("BudgetHistory").pipe(N((t=>t.Expense===e)),N((e=>e["Month Start"]<=t&&t<=e["Month End"]&&e["Year Start"]<=r&&r<=e["Year End"])),L(),ee((e=>{if(e.length>1)console.warn("Unexpected multiple rollover entries found for the same month, year, and expense",e);else if(1===e.length)return ae(e[0].Amount);return o})))),s.pipe(L(),U((e=>n(parseFloat(e[0]))))).subscribe({error(e){i(e)}})}))}var ye=r(44809),ve=r.n(ye);class me{static fromCsv(e){const t=ve().parse(e,{header:!0}).data;return t.forEach((async e=>{e["Description 1"]?(e.id=await async function(e){const t=function(e){return(new TextEncoder).encode(`\n    ${e["Transaction Date"]}\n    ${e["Account Number"]}\n    ${e["Description 1"]}\n    ${e["Description 2"]}\n    ${e.CAD$}\n    ${e.USD$}\n  `)}(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(e),e["Transaction Date"]=new Date(e["Transaction Date"]),e.Month=e["Transaction Date"].getMonth()+1,e.Year=e["Transaction Date"].getFullYear(),e.Date=e["Transaction Date"].toLocaleDateString(),e.CAD$=e.CAD$?parseFloat(e.CAD$.toString()):null,e.USD$=e.USD$?parseFloat(e.USD$.toString()):null,e.Amount=e.USD$||e.CAD$||0,e.Description=e["Description 1"]+" "+e["Description 2"]):t.splice(t.indexOf(e),1)})),t}}function ge(e){e.preventDefault(),e.stopPropagation()}function be(e){var t=e.dataTransfer.files;if(t.length>0){var r=t[0],n=new FileReader;n.onload=we,n.readAsText(r)}}async function we(e){console.log("File upload event:",e);var t=e.target.result;const r=await async function(e){var t=me.fromCsv(e);console.log("Incoming Transactions:",t);const r=await he();console.log("Expenses:",r);const n=await async function(){return new Promise(((e,t)=>{ce("MatchingRules").pipe(L()).subscribe({next:t=>e(t),error:e=>t(e)})}))}();console.log("Matching Rules:",n);const i=await async function(){return new Promise(((e,t)=>{ce("Accounts").pipe(M((e=>{var t={};return t[e.Number]=e.Name,t})),P(((e,t)=>({...e,...t})),{})).subscribe({next:t=>e(t),error:e=>t(e)})}))}();console.log("accountNames:",i);const o=await async function(){return new Promise(((e,t)=>{ue("TransactionIds").pipe(L(),U((t=>e(t)))).subscribe({error(e){t(e)}})}))}(),s=[],a=new Map,u=new Array;return n.forEach((e=>{const t=`${e["Match 1"]}${e["Match 2"]}`;a.set(t,e["Expense Type"]),e["Match 2"]||u.push(e["Match 1"])})),t.forEach((e=>{if(e.id&&o.includes(e.id))return;s.push(e),e["Account Name"]=i[e["Account Number"]],e.Account=`${e["Account Name"]} (${e["Account Number"].slice(-4)})`;let t=a.get(`${e["Description 1"]}${e["Description 2"]}`);if(t)e.Expense=t;else{for(let t of u)if(e["Description 1"].toLowerCase().startsWith(t.toLowerCase())){let r=a.get(t);return void(e.Expense=r)}console.warn("No match found for transaction:",e["Description 1"],e["Description 2"]),le("MatchingRules",{"Match 1":e["Description 1"],"Match 2":e["Description 2"],Amount:"","Expense Type":"Expense Type"})}})),console.log("New Transactions:",s),s.map((e=>[e.id,e.Month,e.Year,e.Date,e.Account,e.Expense,e.Amount,e.Description,e.Memo]))}(t);await fe("Transactions",r)}var _e=Array.isArray,Ee=Object.getPrototypeOf,xe=Object.prototype,ke=Object.keys;var Se=Array.isArray;function Re(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n,i=function(t){return e(te(t))?t.pop():void 0}(t),o=function(e){if(1===e.length){var t=e[0];if(_e(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&Ee(n)===xe){var r=ke(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var n;return{args:e,keys:null}}(t),s=o.args,c=o.keys,l=new H((function(e){var t=s.length;if(t)for(var r=new Array(t),n=t,i=t,o=function(t){var o=!1;X(s[t]).subscribe(D(e,(function(e){o||(o=!0,i--),r[t]=e}),(function(){return n--}),void 0,(function(){n&&o||(i||e.next(c?function(e,t){return e.reduce((function(e,r,n){return e[r]=t[n],e}),{})}(c,r):r),e.complete())})))},a=0;a<t;a++)o(a);else e.complete()}));return i?l.pipe((n=i,M((function(e){return function(e,t){return Se(t)?e.apply(void 0,u([],a(t))):e(t)}(n,e)})))):l}async function Oe(e,t,r){return new Promise(((n,i)=>{ce("Rollovers").pipe(N((r=>r.Month===e&&r.Year===t)),N((e=>e.Expense===r)),L(),ee((n=>{if(n.length>1)console.warn("Unexpected multiple rollover entries found for the same month, year, and expense",n);else if(1===n.length)return ae(n[0]);const i=ce("Transactions").pipe(N((r=>r.Month===e&&r.Year===t)),N((e=>e.Expense===r)),P(((e,t)=>e+t.Amount),0)),o=se(async function(e){return new Promise(((t,r)=>{ce("ExpenseData").pipe(N((t=>t["Expense Type"]===e)),M((e=>e.Init)),L(),U((e=>t(parseFloat(e[0]))))).subscribe({error(e){r(e)}})}))}(r));return Re([i,o,se(de(r,e,t))]).pipe(ee((([n,i,o])=>{const s={Month:e,Year:t,Expense:r,Expenses:n,BOM:i,EOM:i};return se(le("Rollovers",s)).pipe(M((()=>s)))})))})),U((e=>n(e)))).subscribe({error:e=>i(e)})}))}async function Te(e){return new Promise(((t,r)=>{ce("Rollovers").pipe(L(),ee((t=>{const n=t.findIndex((t=>t.Month===e.Month&&t.Year===e.Year&&t.Expense===e.Expense));return-1===n?(console.error("No matching row found to update."),r(new Error("No matching row found.")),se([null])):se(async function(e,t,r){await Excel.run((async e=>{const n=e.workbook.tables.getItem("Rollovers"),i=n.getDataBodyRange().getRow(t),o=n.getHeaderRowRange().load("values");await e.sync();const s=o.values[0].map((e=>r[e]??null));i.values=[s],await e.sync()})).catch((e=>{throw console.error("Error updating row in table:",e),e}))}(0,n,e))})),U({next:()=>t(),error:e=>r(e)})).subscribe()}))}async function Ae(){try{var e=parseInt(document.getElementById("month-input").value),t=parseInt(document.getElementById("year-input").value);let r=document.getElementById("expense-dropdown"),n=r.options[r.selectedIndex].text;"All Expenses"===n&&(n=null),await Excel.run((async r=>{await async function(e,t,r=null){let n;n=r?[r]:await he();let i=new Date,o=i.getMonth()+1,s=i.getFullYear();for(const r of n){let n=24,i=e,a=t;if(a>s||a===s&&i>o)return void console.error("Cannot reset rollover for a future date.");for(;(a<s||a===s&&i<=o)&&n>0;){const e=await Oe(i,a,r),t=await de(r,i,a);let o=i-1,s=a;0===o&&(o=12,s--);const u=await Oe(o,s,r),c=(await pe(i,a,r)).reduce(((e,t)=>e+t.Amount),0);e.Expenses=c,e.BOM=u.EOM,e.EOM=e.BOM+t+c,await Te(e),i++,13===i&&(i=1,a++),n--}}}(e,t,n),r.workbook.getSelectedRange().values=[["Done"]],await r.sync()}))}catch(e){console.error(e)}}Office.onReady((e=>{if(e.host===Office.HostType.Excel){let e=document.getElementById("drop-area");["dragenter","dragover","dragleave","drop"].forEach((t=>{e.addEventListener(t,ge,!1)})),["dragenter","dragover"].forEach((t=>{e.addEventListener(t,(t=>{e.classList.add("highlight")}),!1)})),["dragleave","drop"].forEach((t=>{e.addEventListener(t,(t=>{e.classList.remove("highlight")}),!1)})),e.addEventListener("drop",be,!1),document.getElementById("reset").onclick=Ae,window.onload=async()=>{await async function(){try{const e=await he(),t=document.getElementById("expense-dropdown");t.innerHTML='<option value="">All Expenses</option>';for(const r of e){const e=document.createElement("option");e.value=e.text=r,t.add(e)}}catch(e){console.error("Could not populate the expense dropdown:",e)}}()}}}))}(),function(){"use strict";var e=r(14385),t=r.n(e),n=new URL(r(58394),r.b);t()(n)}()}();
//# sourceMappingURL=taskpane.js.map